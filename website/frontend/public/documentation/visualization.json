{
  "id": "visualization",
  "title": "Visualization - Visual Analytics",
  "description": "Comprehensive visualization tools for Wall Library operations",
  "content": [
    {
      "type": "text",
      "content": "**Visualization** module provides comprehensive visual analytics including 3D graphs, word clouds, context boundaries, and monitoring dashboards. It helps you understand your LLM application's performance through visual representations, making it easier to identify patterns, issues, and opportunities for improvement."
    },
    {
      "type": "section",
      "title": "Understanding Visualization",
      "subsections": [
        {
          "title": "What is Visualization?",
          "type": "text",
          "content": "Visualization converts your Wall Library data into visual representations:\n\n- **Charts**: Bar charts, pie charts, line charts\n- **3D Graphs**: Interactive 3D scatter plots\n- **Word Clouds**: Visual word frequency\n- **Dashboards**: Comprehensive analytics dashboards\n\nVisualizations help you:\n- **Understand patterns**: See trends and patterns in your data\n- **Identify issues**: Spot problems visually\n- **Present results**: Share insights with stakeholders\n- **Debug**: Visualize where issues occur"
        },
        {
          "title": "Why Visualize?",
          "type": "list",
          "items": [
            "**Better Understanding**: Visuals are easier to understand than numbers",
            "**Pattern Recognition**: Spot trends and patterns quickly",
            "**Presentation**: Share results with non-technical stakeholders",
            "**Debugging**: Visualize where issues occur",
            "**Analysis**: Compare different metrics visually",
            "**Reporting**: Generate visual reports"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "Visualization Types - Detailed Explanation",
      "subsections": [
        {
          "title": "Score Visualization",
          "type": "text",
          "content": "**Score Visualization** creates bar charts showing metric scores with color coding.\n\n- **What it shows**: Individual metric scores (ROUGE, BLEU, Cosine Similarity, etc.)\n- **Color coding**: Green (≥0.7), Yellow (0.5-0.7), Red (<0.5)\n- **Use cases**: Compare scores across metrics, identify which metrics are low\n- **Output**: PNG image file\n\n**Example**: Shows that ROUGE score is 0.72 (green), BLEU is 0.68 (yellow), indicating good content overlap but slightly lower precision."
        },
        {
          "title": "Context Boundaries Visualization",
          "type": "text",
          "content": "**Context Boundaries** shows inside/outside wall analysis with pie charts and similarity distributions.\n\n- **What it shows**: How many responses are inside vs outside approved context boundaries\n- **Pie chart**: Percentage of responses inside/outside\n- **Bar chart**: Similarity scores for each response\n- **Use cases**: Understand context compliance, identify responses going outside boundaries\n- **Output**: PNG image file\n\n**Example**: Shows 80% of responses are inside healthcare context (green), 20% outside (red), with similarity scores for each response."
        },
        {
          "title": "Keyword Analysis",
          "type": "text",
          "content": "**Keyword Analysis** shows frequency and distribution charts for keywords.\n\n- **What it shows**: How often keywords appear in responses\n- **Frequency chart**: Bar chart showing keyword frequencies\n- **Distribution chart**: Shows keyword distribution across responses\n- **Use cases**: Understand which keywords are most common, identify missing keywords\n- **Output**: PNG image file\n\n**Example**: Shows \"healthcare\" appears 50 times, \"medical\" appears 30 times, \"symptom\" appears 25 times, helping you understand response content."
        },
        {
          "title": "Word Clouds",
          "type": "text",
          "content": "**Word Clouds** create visual word frequency representations.\n\n- **What it shows**: Words sized by frequency (larger = more frequent)\n- **Visual style**: Colorful word cloud with different sizes\n- **Use cases**: Quick visual overview of most common words, domain analysis\n- **Output**: PNG image file\n\n**Example**: Shows large words like \"healthcare\", \"medical\", \"symptom\" (frequent) and smaller words like \"therapy\", \"wellness\" (less frequent)."
        },
        {
          "title": "3D Embeddings Visualization (IMPORTANT)",
          "type": "text",
          "content": "**3D Embeddings** creates interactive 3D scatter plots showing embedding space.\n\n- **What it shows**: Responses plotted in 3D embedding space (reduced from high dimensions using PCA)\n- **Interactive**: Can rotate, zoom, hover for details\n- **Color coding**: Colors based on z-axis value or labels\n- **Use cases**: Understand semantic relationships, cluster analysis, identify outliers\n- **Output**: Interactive HTML file (open in browser)\n\n**Example**: Shows 20 responses as points in 3D space. Responses about diabetes cluster together, responses about blood pressure cluster separately, showing semantic relationships visually."
        },
        {
          "title": "3D Scores Visualization (IMPORTANT)",
          "type": "text",
          "content": "**3D Scores** creates multi-metric 3D visualization.\n\n- **What it shows**: Responses plotted in 3D space with x/y/z axes representing different metrics\n- **Axes**: X = CosineSimilarity, Y = ROUGEMetric, Z = BLEUMetric (configurable)\n- **Interactive**: Can rotate, zoom, hover for details\n- **Color coding**: Colors based on z-axis value\n- **Use cases**: Compare multiple metrics simultaneously, identify high/low quality responses\n- **Output**: Interactive HTML file\n\n**Example**: Shows responses as points where x=CosineSimilarity, y=ROUGEMetric, z=BLEUMetric. Points in the \"good\" region (high x, y, z) are green, points in \"poor\" region are red."
        },
        {
          "title": "Validation Results Timeline",
          "type": "text",
          "content": "**Validation Results Timeline** shows validation performance over time.\n\n- **What it shows**: Pass/fail rates, error types, performance trends\n- **Timeline chart**: Line chart showing trends over time\n- **Use cases**: Track validation performance, identify when issues started\n- **Output**: PNG image file"
        },
        {
          "title": "RAG Retrieval Analysis",
          "type": "text",
          "content": "**RAG Retrieval Analysis** shows score and distance distributions.\n\n- **What it shows**: Distribution of retrieval scores and distances\n- **Histogram**: Shows how scores are distributed\n- **Use cases**: Understand retrieval quality, identify low-quality retrievals\n- **Output**: PNG image file"
        },
        {
          "title": "Monitoring Dashboard",
          "type": "text",
          "content": "**Monitoring Dashboard** is a comprehensive analytics dashboard.\n\n- **What it shows**: Total interactions, success rate, average latency, error distribution, latency trends\n- **Multiple panels**: Metrics, charts, statistics\n- **Use cases**: Overall system health, performance monitoring, issue identification\n- **Output**: PNG image file\n\n**Example**: Shows total interactions: 150, success rate: 92%, avg latency: 0.45s, error distribution chart, latency over time chart."
        }
      ]
    },
    {
      "type": "section",
      "title": "Complete Usage Guide",
      "subsections": [
        {
          "title": "Step 1: Import and Create Visualizer",
          "type": "code",
          "code": "from wall_library.visualization import WallVisualizer\nimport os\n\n# Create output directory for visualizations\noutput_dir = os.path.join(os.getcwd(), \"visualizations\")\nos.makedirs(output_dir, exist_ok=True)\n\n# Create visualizer\nviz = WallVisualizer(output_dir=output_dir)\n\n# Visualizer is ready to create visualizations",
          "input": "Creating visualizer...",
          "output": "✅ Visualizer created"
        },
        {
          "title": "Step 2: Visualize Scores",
          "type": "code",
          "code": "# Visualize response quality scores\nscores = {\n    \"CosineSimilarity\": 0.85,\n    \"ROUGEMetric\": 0.72,\n    \"BLEUMetric\": 0.68,\n    \"SemanticSimilarity\": 0.79\n}\n\n# Create bar chart\nviz.visualize_scores(\n    scores=scores,\n    title=\"Response Quality Scores\",\n    threshold=0.7  # Green/yellow/red threshold\n)\n\n# Output: visualizations/scores.png\n# Shows bar chart with:\n# - CosineSimilarity: 0.85 (green bar, above threshold)\n# - ROUGEMetric: 0.72 (green bar, above threshold)\n# - BLEUMetric: 0.68 (yellow bar, below threshold)\n# - SemanticSimilarity: 0.79 (green bar, above threshold)",
          "input": "Visualizing scores...",
          "output": "✅ Generated: visualizations/scores.png"
        },
        {
          "title": "Step 3: Visualize Context Boundaries",
          "type": "code",
          "code": "from wall_library.nlp import ContextManager\n\n# Setup context manager\ncontext_manager = ContextManager()\ncontext_manager.add_keywords([\"healthcare\", \"medical\"])\n\n# Test responses\nresponses = [\n    \"Common symptoms of diabetes include increased thirst and frequent urination.\",\n    \"This is a guaranteed cure for diabetes that will definitely work.\",\n    \"Blood pressure medications should be taken as prescribed.\",\n    \"Here's a recipe for chocolate cake.\",\n    \"Preventive screenings vary by age and risk factors.\"\n]\n\n# Visualize context boundaries\nviz.visualize_context_boundaries(\n    responses=responses,\n    context_manager=context_manager,\n    threshold=0.7,\n    title=\"Healthcare Context Boundaries\"\n)\n\n# Output: visualizations/context_boundaries.png\n# Shows:\n# - Pie chart: 60% inside (green), 40% outside (red)\n# - Bar chart: Similarity scores for each response\n# - Threshold line at 0.7",
          "input": "Visualizing context boundaries...",
          "output": "✅ Generated: visualizations/context_boundaries.png"
        },
        {
          "title": "Step 4: Generate Word Cloud",
          "type": "code",
          "code": "# Generate word cloud from text\ntext = \"healthcare medical doctor patient symptom diagnosis treatment medication prescription therapy wellness disease condition hospital clinic appointment care healthcare physician nurse medicine clinical therapeutic preventive screening vaccination mental health nutrition exercise rehabilitation\"\n\nviz.visualize_wordcloud(\n    text=text,\n    title=\"Healthcare Domain Word Cloud\",\n    max_words=50  # Maximum number of words to display\n)\n\n# Output: visualizations/wordcloud.png\n# Shows word cloud with:\n# - Large words: healthcare, medical, doctor, patient (high frequency)\n# - Medium words: symptom, diagnosis, treatment\n# - Small words: therapy, wellness, condition",
          "input": "Generating word cloud...",
          "output": "✅ Generated: visualizations/wordcloud.png"
        },
        {
          "title": "Step 5: 3D Embeddings Visualization",
          "type": "code",
          "code": "import numpy as np\nfrom wall_library.rag import EmbeddingService\n\n# Generate embeddings for responses\nembedding_service = EmbeddingService(provider=\"sentence-transformers\")\nresponses = [\n    \"Common symptoms of diabetes include increased thirst and frequent urination.\",\n    \"Blood pressure medications should be taken as prescribed.\",\n    \"Preventive screenings vary by age and risk factors.\",\n    # ... more responses\n]\n\n# Get embeddings (384 dimensions each)\nembeddings = [embedding_service.embed(r) for r in responses]\n\n# Create labels with metadata\nlabels = [\n    {\n        \"label\": f\"Response {i+1}\",\n        \"text\": response,\n        \"keywords\": [\"healthcare\", \"medical\"],\n        \"metadata\": {\"domain\": \"healthcare\", \"index\": i}\n    }\n    for i, response in enumerate(responses)\n]\n\n# Visualize 3D embeddings\nviz.visualize_3d_embeddings(\n    embeddings=embeddings,\n    labels=labels,\n    title=\"3D Embedding Space - Healthcare Responses\"\n)\n\n# Output: visualizations/3d_embeddings.html\n# Interactive 3D plot where:\n# - Each point represents one response\n# - Points close together = semantically similar\n# - Can rotate, zoom, hover for details\n# - Colors based on z-axis value",
          "input": "Generating 3D embeddings visualization...",
          "output": "✅ Generated: visualizations/3d_embeddings.html"
        },
        {
          "title": "Step 6: 3D Scores Visualization",
          "type": "code",
          "code": "from wall_library.scoring import ResponseScorer\n\n# Score multiple responses\nscorer = ResponseScorer()\nscorer.metrics.append(ROUGEMetric())\nscorer.metrics.append(BLEUMetric())\n\n# Score responses\nscores_data = []\nfor response in responses:\n    scores = scorer.score(response, expected_output)\n    scores_data.append({\n        \"CosineSimilarity\": scores.get(\"CosineSimilarityMetric\", 0.0),\n        \"ROUGEMetric\": scores.get(\"ROUGEMetric\", 0.0),\n        \"BLEUMetric\": scores.get(\"BLEUMetric\", 0.0),\n        \"label\": f\"Response {len(scores_data)+1}\",\n        \"text\": response,\n        \"keywords\": [\"healthcare\"],\n        \"metadata\": {\"domain\": \"healthcare\"}\n    })\n\n# Visualize 3D scores\nviz.visualize_3d_scores(\n    scores_data=scores_data,\n    x_metric=\"CosineSimilarity\",\n    y_metric=\"ROUGEMetric\",\n    z_metric=\"BLEUMetric\",\n    title=\"3D Score Space Visualization\"\n)\n\n# Output: visualizations/3d_scores.html\n# Interactive 3D plot where:\n# - X-axis = CosineSimilarity\n# - Y-axis = ROUGEMetric\n# - Z-axis = BLEUMetric\n# - Points in \"good\" region (high x, y, z) are green\n# - Points in \"poor\" region are red\n# - Can rotate, zoom, hover for details",
          "input": "Generating 3D scores visualization...",
          "output": "✅ Generated: visualizations/3d_scores.html"
        },
        {
          "title": "Step 7: Monitoring Dashboard",
          "type": "code",
          "code": "from wall_library.monitoring import LLMMonitor\n\n# Get monitoring data\nmonitor = LLMMonitor()\n# ... track some calls ...\n\nstats = monitor.get_stats()\n\n# Prepare dashboard data\nmonitor_data = {\n    \"total_interactions\": stats['total_interactions'],\n    \"success_rate\": stats['metrics'].get('success_rate', 0.0),\n    \"avg_latency\": stats['metrics'].get('avg_latency', 0.0),\n    \"latencies\": [i['latency'] for i in monitor.interactions if i.get('latency')],\n    \"errors\": {\n        \"ValidationError\": sum(1 for i in monitor.interactions if 'ValidationError' in str(i.get('metadata', {}).get('error', ''))),\n        \"TimeoutError\": sum(1 for i in monitor.interactions if 'TimeoutError' in str(i.get('metadata', {}).get('error', ''))),\n    },\n    \"metrics\": stats['metrics']\n}\n\n# Generate dashboard\nviz.visualize_monitoring_dashboard(\n    monitor_data=monitor_data,\n    title=\"LLM Monitoring Dashboard\"\n)\n\n# Output: visualizations/monitoring_dashboard.png\n# Shows comprehensive dashboard with:\n# - Total interactions (large number)\n# - Success rate (large number with color)\n# - Average latency (large number)\n# - Latency over time (line chart)\n# - Error distribution (bar chart)\n# - Metrics summary (text)",
          "input": "Generating monitoring dashboard...",
          "output": "✅ Generated: visualizations/monitoring_dashboard.png"
        }
      ]
    },
    {
      "type": "section",
      "title": "Understanding 3D Visualizations",
      "subsections": [
        {
          "title": "3D Embeddings - What It Shows",
          "type": "text",
          "content": "3D Embeddings visualization reduces high-dimensional embeddings (e.g., 384 dimensions) to 3D using PCA (Principal Component Analysis).\n\n**What you see**:\n- Each point = one response\n- Points close together = semantically similar responses\n- Points far apart = semantically different responses\n- Clusters = groups of similar responses\n\n**How to use**:\n1. Open the HTML file in a browser\n2. Rotate: Click and drag\n3. Zoom: Scroll or pinch\n4. Hover: See details for each point\n5. Look for clusters: Similar responses cluster together\n\n**Use cases**:\n- Understand semantic relationships\n- Identify response clusters\n- Find outliers (points far from clusters)\n- Compare different domains"
        },
        {
          "title": "3D Scores - What It Shows",
          "type": "text",
          "content": "3D Scores visualization plots responses in 3D space where each axis represents a different metric.\n\n**What you see**:\n- X-axis = First metric (e.g., CosineSimilarity)\n- Y-axis = Second metric (e.g., ROUGEMetric)\n- Z-axis = Third metric (e.g., BLEUMetric)\n- Each point = one response with its scores\n- Colors = Quality (green = good, red = poor)\n\n**How to use**:\n1. Open the HTML file in a browser\n2. Rotate to see from different angles\n3. Look for \"good\" region (high x, y, z values)\n4. Identify responses in \"poor\" region (low x, y, z values)\n\n**Use cases**:\n- Compare multiple metrics simultaneously\n- Identify high/low quality responses\n- Understand metric relationships\n- Set quality thresholds"
        }
      ]
    },
    {
      "type": "section",
      "title": "Best Practices",
      "subsections": [
        {
          "title": "Recommendations",
          "type": "list",
          "items": [
            "**Use appropriate visualizations**: Choose the right visualization for your data",
            "**3D for exploration**: Use 3D visualizations to explore relationships",
            "**2D for presentation**: Use 2D charts (bar, pie) for presentations",
            "**Combine visualizations**: Use multiple visualizations for comprehensive analysis",
            "**Regular generation**: Generate visualizations regularly to track trends",
            "**Share insights**: Use visualizations to share insights with stakeholders",
            "**Interactive exploration**: Use interactive 3D visualizations to explore data"
          ]
        },
        {
          "title": "When to Use Each Visualization",
          "type": "list",
          "items": [
            "**Score Visualization**: When comparing metric scores",
            "**Context Boundaries**: When analyzing context compliance",
            "**Word Cloud**: When showing domain keywords",
            "**3D Embeddings**: When exploring semantic relationships",
            "**3D Scores**: When comparing multiple metrics",
            "**Monitoring Dashboard**: When showing overall system health"
          ]
        }
      ]
    }
  ]
}
